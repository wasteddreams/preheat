.TH PREHEAT.CONF 5 "December 2025" "preheat 1.0.0" "File Formats"
.SH NAME
preheat.conf \- configuration file for preheat daemon
.SH SYNOPSIS
.I /usr/local/etc/preheat.conf
.PP
(Path varies by install prefix; system packages may use \fI/etc/preheat.conf\fR)
.SH DESCRIPTION
Configuration file for the \fBpreheat\fR(8) daemon.
Uses INI-style format with sections and key=value pairs.

Default values maintain behavioral parity with upstream preload 0.6.4.
.SH FORMAT
.nf
# Comments start with #
[section]
key = value
.fi
.SH SECTIONS
.SS [model]
Controls prediction and memory behavior.

.TS
l l l.
\fBParameter\fR	\fBDefault\fR	\fBDescription\fR
cycle	20	Scan interval in seconds
minsize	2000000	Min app size to track (bytes)
memtotal	-10	% of total RAM for preloading
memfree	50	% of free RAM for preloading
memcached	0	% of cached RAM for preloading
.TE

.B Memory Formula:
.br
Available = max(0, Total×memtotal/100 + Free×memfree/100) + Cached×memcached/100

.SS [system]
Controls performance and I/O.

.TS
l l l.
\fBParameter\fR	\fBDefault\fR	\fBDescription\fR
doscan	true	Enable process scanning
dopredict	true	Enable prediction/preloading
autosave	3600	State save interval (seconds)
maxprocs	30	Parallel readahead processes
sortstrategy	3	File sort: 0=none, 3=block
manualapps	(empty)	Path to manual whitelist file
usecorrelation	true	Use Markov correlation
.TE

.TP
\fBmanualapps\fR
Path to a file containing applications to always preload with highest priority.
File format: one absolute path per line, lines starting with # are comments.
.br
Example: manualapps = /etc/preheat.d/apps.list

.SS [preheat]
Preheat-specific extensions (not in upstream preload).

.TP
\fBexcluded_patterns\fR
Glob patterns for system processes to exclude from priority pool tracking.
Semicolon-separated patterns.
.br
Default: /usr/lib/*;/usr/libexec/*;*systemd*;*dbus*
.br
Excluded applications are still tracked in observation pool for pattern
learning but not shown in user stats.

.TP
\fBuser_app_paths\fR
Additional directories containing user applications for priority pool.
Semicolon-separated paths.
.br
Default: /opt/*;/usr/local/bin/*
.br
Applications matching these paths are promoted to priority pool even
without desktop files.

.TP
\fBblacklist\fR
Path to a file containing applications to never preload.
Applications are still tracked for pattern learning but never preloaded.
File format: one application name per line (basename, not full path).
.br
Default: Loaded automatically from /etc/preheat.d/blacklist
.br
Example: blacklist = /etc/preheat.d/blacklist

.SH TWO-TIER TRACKING SYSTEM
Preheat uses a two-tier architecture to separate user applications from
system processes:

.B Priority Pool:
.br
User applications that appear in stats and get preloaded:
.TP
\\(bu GUI applications with .desktop files
.TP
\\(bu Applications in user_app_paths directories
.TP
\\(bu Applications manually promoted via configuration

.B Observation Pool:
.br
System processes tracked for pattern learning but hidden from stats:
.TP
\\(bu System daemons (systemd, dbus, etc.)
.TP
\\(bu Background services from /usr/lib, /usr/libexec
.TP
\\(bu Applications matching excluded_patterns

This separation keeps stats focused on the applications users care about
while Markov chain learning benefits from observing all processes.

.SS [ignore]
Controls path filtering.

.TP
\fBexeprefix\fR
Executable path filters. Semicolon-separated.
.br
Default: !/usr/sbin/;!/usr/local/sbin/;/usr/;!/
.br
! prefix = exclude
.TP
\fBmapprefix\fR
Library path filters. Semicolon-separated.
.br
Default: /usr/;/lib;/var/cache/;!/
.SH EXAMPLES
.SS Conservative (low resource)
.nf
[model]
cycle = 30
memfree = 30
minsize = 5000000

[system]
maxprocs = 10
.fi

.SS Aggressive (high performance)
.nf
[model]
cycle = 10
memfree = 75
memcached = 20

[system]
maxprocs = 50
.fi

.SS SSD Optimization
.nf
[system]
sortstrategy = 0
maxprocs = 50
.fi

.SS With Manual Whitelist and Blacklist
.nf
[system]
manualapps = /etc/preheat.d/apps.list

[preheat]
blacklist = /etc/preheat.d/blacklist
.fi
.SH EXTERNAL FILES
.SS /etc/preheat.d/apps.list
Manual whitelist file. Applications listed here are always preloaded with
highest priority regardless of Markov chain probability.

.B Automatic Path Resolution (v1.0.0+):
.br
Preheat automatically resolves paths to actual ELF binaries:
.TP
\(bu Shell wrappers (e.g., /usr/bin/firefox) \(-> resolved to actual binary
.TP
\(bu Symlinks \(-> followed to real path
.TP
\(bu Interpreter scripts \(-> interpreter binary is preloaded
.TP
\(bu Direct ELF binaries \(-> used as-is

.B Proactive Registration:
.br
Manual apps are registered at daemon startup, even if never run before.
This means they will be preloaded immediately without waiting for first use.

.B Security:
.br
Only paths in trusted locations (/usr/*, /opt/*, /usr/local/*) are accepted.
Paths in /tmp, /home, or other untrusted locations are rejected.

Format:
.nf
# Comments start with #
/usr/bin/firefox
/usr/bin/code
/usr/bin/chromium
.fi
.SS /etc/preheat.d/blacklist
Blacklist file. Applications listed here are never preloaded but still
tracked for pattern learning.

Format:
.nf
# One app name per line (basename only)
# Heavy/slow apps you don't want preloaded
gimp
blender
kdenlive
steam
.fi
.SH RELOADING
Apply changes without restart:
.PP
.RS
.B sudo preheat-ctl reload
.RE
.SH SEE ALSO
.BR preheat (8),
.BR preheat-ctl (1)
.SH AUTHOR
Preheat Contributors
.SH LICENSE
GPL v2. See LICENSE file for details.
